## 字符串相关

### sed（支持正则分区域替换内容）

#### 子命令

-i就地替换目标文件

-e 替换内容

##### 格式

匹配语法	s/{pattern}/{replacement}/flags

1.{pattern}是正则表达式，参数要加-r

2.如果{pattern}存在分组，{replacement}中"\n"表示第n个分组，"&"表示整个匹配的字符串

3.flags

​	(1) n| (n),(n,m)表示第n次出现的情况出现替换

​	(2) g| 全局更改

​	(3) p| 打印模式空间的内容

​	(4) w file| 写入到file文件中

##### 例子

sed 's/替换前/替换后的内容/'

批量替换内容 echo "i need to try hard" | sed 's/hard/harder/'

###### 替换

echo 'need i to try' | sed -r 's/(a-z\*) (a-z\*) (a-z\*)/\\2 \\1 \\3/'

:i need to try

###### 全局替换

echo 'need i to try,need i to try' | sed -r 's/(a-z\*) (i) (a-z\*)/\\2 \\1 \\3/g'

:i need to try,i need to try 

### cut (提取字符串（精简版）)

cut从一行中体重一段文本输出到标准输出

echo "i hack binaries,web apps,mobile apps,anything else" | cut -d ',' -f 2

web apps

-b	仅显示行中指定直接范围的内容

-c	以字符为单位进行分割，截取

-d	自定义分割符，默认制表符\t

-f	与-d一起使用，指定截取那个区域

-n	与“-b”选项连用，不分割多字节字符

--complement	补足被选择的字节、字符、字段

--out-delimiter	字符分割符

--help	帮助

--version	版本

#### 例子

root\:x\:0:0:root:/root:/bin/bash

cut -d ':' -f1 /etc/passwd

#或

cut -d ":" -f1 /etc/passwd

#或

cut -d: -f1/etc/passwd

### awk->gawk->nawk（提取字符串（高级版），支持c++语法的提取文本）

#### 命令格式

格式1：awk [options] 'script' file(s)

格式2：awk [options] -f scriptfile file(s)

-f 从脚本文件里面读取awa命令，每行都是独立的script

-F<=>--field-separator=fs 定义awk程序的分割符，默认分割符是空格

-v 预定义一些变量，在执行AWK程序之前定义

-p <=> = --profile 将当前的awk程序代码格式化输出到file文件

#### awk运算符

-F<=> --field-separator 设置分割符

-h<=> --help 帮助



运算符

分组指派

[$1~$n] 分割符号

正则匹配

~匹配

!~ 不匹配

支持类似C++语法格式

`kali        1439  0.0  0.0  12556  2148 ?        Ssl  03:18   0:00 xcape -e Super_L Control_L Escape`
	`kali        1444  0.0  0.2 146140 36660 ?        Sl   03:18   0:16 /usr/bin/vmtoolsd -n vmusr --blockFd 3`
	`kali        1445  0.0  0.1 331444 17380 ?        Sl   03:18   0:00 xfce4-power-manager`
	`colord      1501  0.0  0.0 316068 14328 ?        Ssl  03:18   0:00 /usr/libexec/colord`
	`kali        1593  0.0  0.1 378696 18208 ?        Ssl  03:18   0:00 /usr/libexec/bluetooth/obexd`
	`kali        1603  0.0  0.0 390872 10856 ?        Ssl  03:18   0:00 /usr/libexec/gvfs-udisks2-volume-monitor`



awk '/\/usr\//'



awk '$11~/\/usr\//'



awk -F \' \' \' '$11~/\/usr\//\'



awk '$11~/\/usr\// {if($2 > 1000){print ;}}'

### grep (global regular search )（搜索高亮字符串（支持正则模式））

基本正则表达式

#### 选项

-i	忽略大小写

#### 符号

^ 锚定行的开始 '^grep' 匹配所有以grep开头的

$ 锚定行的结束  'grep$' 匹配所有以grep结束的

. 匹配一个非换行符的字符如：'gr.p' 匹配gr后接任意一个字符，然后是p

\*匹配零个或者多个先前字符如：'\*grep'

+匹配前面的字符一次或多次，至少匹配一次，可重复

[] 匹配一个指定范围内的字符 '[Gg]rep' 匹配Grep和grep

[^]匹配一个不在指定范围内的字符 \[^A-FH-Z\]grep 匹配不包含

.. 标记匹配字符，如'love',love被标记为1

\\\< 锚定单词的开始 ’\<grep' 匹配包含以grep开头的单词的行

\\\> 锚定单词的结束 '>grep' 匹配包含以grep结尾的单词的行

x\\{m\\} 重复字符x,m次， 如：'o\\{5\\}' 匹配包含5个o的行

x\\{m,\\} 重复字符x,至少m次 'o\\{5,\\}' 匹配至少有5个o的行

x\\{m,n\} 重复字符x,[m<=Count<=n]次 'o\\{5,10\\}' 匹配5-10次o的行

\\w 匹配大小写字母和数字字符 也就是[A-Za-z0-9] 'G\\w*p' 匹配G后跟零个或多个大小字符和数字

\\W \w的反置形式，匹配一个或多个非单词的字符，

\b 单词锁定符 '\\bgrep\\b' 只匹配grep

#### 例子

##### 搜索全是数字的行

grep '^[0-9]+$' test.log

### sort（排序、去除重复）

sort以每一行为一个单位，相互比较。

#### 选项

-u<=> --unique 去除重复行

-r<=>--reverse 降序（默认不加为升序）

-o 输出模式（打开不占用原文件）

-n=<=>--numeric-sort 以数值来排序

-R=<=>--random-sort

-f 忽略大小写

-M<=>--month-sort 月份排序

-b<=>--ignore-leading-blanks 忽略前面空白部分

-t<=>--field-separator 设置间隔符

-k<=>--key=KEYDEF 指定排序行

### uniq（统计重复次数）

#### 选项

-c<=>--count 统计重复的行

### vimdiff (vim differences)（对比文件）

#### 启动参数

-c <-> --cmd 启动vim后执行vim命令cmd

-d 启用diff模式

-R <-> --readonly 以只读模式打开文件

-O <-> --vertical 水平分割窗口，默认是垂直

--remote-tab  在现有的vim实例中打开文件作为新标签页

#### 命令

dd: 剪切当前行

数字dd: 剪切当前行开始的多行

p: 粘贴

:qa 同时退出多个文件

u: 撤销操作

wa: 保存文件

wqa: 保存并退出文件

yy: 复制当前行

数字yy:复制当前行开始的多行

:wqall 退出vimdiff并保存所有文件的更改

:qa! 退出但不保存更改

#### 窗口切换快捷键

ctrl+w w 跳转到另一个窗口

ctrl+w h 跳转到左边窗口

ctrl+w j 跳转到下边的窗口

ctrl+w k 跳转到上边的窗口

ctrl+w l 跳转到右边的窗口

ctrl+w b 跳转到最底下的窗口

ctrl+w t 跳转到最上面的窗口



## 后台进程

Linux内核管理多任务，每个进程拥有唯一PID

Sheel使用job的概念来简化终端会话期间用户工作流程

cat error.txt | wc -m 管道连接两个进程，但是是同一个job

#### 后台进程

前台进程占用终端，后台不占用终端资源

#### 将已启动的前台进程置入后台

切换到后台快捷键：Ctrl + Z 

查看后台列表：jobs

查看后台列表+PID版本: jobs -l

启动指定的后台：bg %<taskId> 

启动最近添加的后台：bg 

设置成前台并启动：fg %<taskId>

设置最近添加的前台并启动：fg

结束任务：kill -9 <pid>

### 进程管理

#### 标识符

PID	ProcessId，进程ID

USER	进程所有者

TTY	进程所在的Terminal

TIME	进程占用CPU的累计时间

CMD	对应命令行参数

#### 进程状态

R	正在运行或可运行(Run,Ready)

S	休眠（Sleeping)

D	不可中断休眠（Disk Sleep,通常I/O等待）

Z	僵尸进程（已结束，未被回收）

#### 参数

-a 显示所有终端的进程（包括非登录用户）

-x 关联到终端进程

-u 以用户友好模式显示进程

-f 森林树显示进程层次结构

-sort=-%men 以内存占用排序

-fC <prcName> 搜索进程

#### 显示进程列表

列出当前系统进程: ps -ef

f -> 显示全部格式(UID,PID,PPID,etc.)

e ->选择所有进程

BSD格式显示进程: ps aux

#### 通过名称查找进程

ps -fC <进程名>

#### 结束进程（发送SIGTERM信息）

kill -<signal> <PID> //signal = 9 强制结束

pkill -f '关键词' //结束关键词进程

#### Watch 周期性执行命令

watch -n <秒> <命令>

## 监视文件

#### 查看文件头部/尾部

查看文件最前5条：sudo head -f <路径>

查看文件最前10条：sudo head -n10 <路径>

查看文件最后5条：sudo tail -f <路径>

查看文件最后10条：sudo tail -n10 <路径>

## 下载

#### wget

支持http/https/ftp协议

|                          |                                                      |
| :----------------------- | ---------------------------------------------------- |
| -h <=> --help            | 帮助                                                 |
| -v <=> --version         | 版本                                                 |
| -b <=> --background      | 启动后转入后台执行                                   |
| -e <=> --execute         | 执行命令                                             |
| -o <=> --output-file     | 输出日志文件覆盖                                     |
| -a <=> --append-output   | 输入日志文件插入尾部                                 |
| -d <=> --debug           | 打印debug信息                                        |
| -v <=> --verbose         | 详细的日志                                           |
| -nv <=> --no-verbose     | 关闭详细输出                                         |
| -i <=> --input-file      | 下载本地或外部的URL                                  |
| -F <=> --force-html      | 强制把输入的文件当html格式                           |
| -B <=> --base            | 域名？-i -F的前序，也可以不要可以直接写详细的url地址 |
| -t <=> --tires           | 设置重试次数 0 为无限制                              |
| -c <=> --continue        | 断点续传模式                                         |
| --progress=(dot\|bar)    | 显示进度条（Dot点）（Bar百分比）                     |
| -N <=> --timestamping    | 只获取比本地文件日期新的文件                         |
| -S <=> --server-response | 打印服务器响应                                       |
| --spider                 | 不下载文件只检查文件是否存在                         |
| --connect-timeout        | 设置连接超时（秒）                                   |
| --read-timeout           | 设置读取超时（秒）                                   |
| --no-proxy               | 禁止代理                                             |
| --no-dns-cache           | 禁止DNS缓存                                          |
| -4 <=> --inet4-only      | 仅连接ipv4地址                                       |
| -6 <=> --inet6-only      | 仅连接ipv6地址                                       |
| --no-cookies             | 不使用cookies                                        |
| --no-cache               | 不在服务器缓存数据                                   |
| --post-data=string       | 使用post，发送数据                                   |
| --post-file=filepath     | 使用post，发送文件                                   |
| --ftp-user               | 设置ftp用户名                                        |
| --ftp-pass               | 设置ftp密码                                          |



#### curl

支持 IMAP/S,POP/S,SCP,SMB/S,SMTP/S,TELENET,TFTP,下载，上传

##### 请求控制

|                       |                                |                                               |
| --------------------- | ------------------------------ | --------------------------------------------- |
| -x <(GET\\POST\\PUT)> | 指定HTTP请求方法               | curl -x POST http://baidu.com                 |
| -H "Header:val"       | 添加请求头                     | curl -H "Content-Type:application/json" <url> |
| -d "data"             | POST数据                       | curl -d "name=zgh" <url>                      |
| --data-raw            | 原始POST数据                   | curl --data-raw'{"key","value"}' <url>        |
| --data-binary         | 二进制数据（保留特殊符号）     | curl-data-binary @file.txt <url>              |
| -F                    | 上传文件（multipart/from-data) | curl -F "file=@test.txt" <url>                |

##### 输出控制

|                |                               |                           |
| -------------- | ----------------------------- | ------------------------- |
| -o <file>      | 将输出保存到文件              | curl -o xx.html <urL>     |
| -O             | 使用远程文件名保存            | curl -O <url>             |
| -s             | 静默模式（不显示进度条/错误） | curl -s <url>             |
| -v             | 显示详细通信过程              | curl -v <url>             |
| --trace <file> | 将完整通信过程记录文件        | curl --trace xx.log <url> |

##### 连接控制

|                         |                        |                                |
| ----------------------- | ---------------------- | ------------------------------ |
| --connect-timeout <sec> | 连接超时时间（秒）     | curl --connect-timeout 5 <url> |
| -m <sec>                | 最大请求时间（秒）     | curl -m 5 <url>                |
| --retry <num>           | 失败重试次数           | curl --retry 3 <url>           |
| --compressed            | 要求服务器返回压缩数据 | curl --compressed <url>        |

##### 代理模式

|                  |              |                               |
| ---------------- | ------------ | ----------------------------- |
| -x <proxy>       | 使用http代理 | curl -x http://xxx:1080 <url> |
| --socks5 <host>  | socks5代理   | curl --socks5 xxx:1080 <url>  |
| --interface <if> | 指定网络接口 | curl --interface eth0 <url>   |



#### axel

支持FTP/HTTP加速下载，断点续传

axel [options] <url>



## alias别名（类似c++#define宏）

#### 定义别名

alias xx=''ls -la"

#### 取消定义别名

unalias xx

#### 渗透注意

可能保存账号密码，DB信息

####  别名持久化

系统范围Bash配置文件 /etc/bash/bashrc

~/.bashrc 可覆盖 系统配置文件