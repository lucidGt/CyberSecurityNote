# 🧩 AD 域（Active Directory）TODO LIST

> 说明：以下清单用于**授权环境**下练习 AD 基础到拿域控/域管的完整链路。  
> 不支持点击勾选的 Markdown 环境，可手动把 [ ] 改成 [x]。

---

## ✅ 0) 基础概念（必须理解）

- [ ] 了解 AD 组件：Domain / Forest / DC / OU / GPO / DNS
- [ ] 了解身份对象：User / Group / Computer / Service Account
- [ ] 了解认证：Kerberos vs NTLM（什么时候用哪个）
- [ ] 了解关键概念：SPN / TGT / TGS / SID / ACL
- [ ] 了解常见高权限组：Domain Admins / Enterprise Admins / Account Operators / Server Operators / Backup Operators
- [ ] 了解常见协议与端口：DNS(53)、LDAP(389/636)、Kerberos(88)、SMB(445)、RPC(135+)、WinRM(5985/5986)、RDP(3389)

---

## ✅ 1) 环境与工具准备（实战必备）
- [ ] Kali/攻击机：能用 impacket 常用工具（wmiexec/psexec/smbclient 等）
- [ ] Kali/攻击机：能用 BloodHound（采集 + 图分析）
- [ ] Kali/攻击机：能用 Kerberos 相关枚举/请求工具（以“合法测试”为前提）
- [ ] Windows 跳板机（可选但强烈建议）：RSAT/PowerView 或等价枚举方式
- [ ] 证据记录：每一步都能截图/命令复现（为报告做准备）

---

## ✅ 2) 第一次接触域：Recon & 枚举（你看到“域”先做这些）
- [ ] 确定域名/主机名/网段范围（从网页、SMB banner、DNS、证书信息等）
- [ ] 确定是否存在 DC（nmap/服务特征：88/389/445/53）
- [ ] DNS 枚举：确认域控主机名、重要子域/记录（A/AAAA/SRV）
- [ ] SMB 基础枚举：共享、策略文件、脚本、可能的凭据线索
- [ ] LDAP 访问性判断（匿名/低权是否可读基础对象）
- [ ] 收集用户名候选（网页、邮件格式、SMB、LDAP、文档元数据等）
- [ ] 收集“可用凭据”（明文/哈希/票据/SSH key/配置文件/备份）

---

## ✅ 3) 低权凭据到手后：域内信息枚举（核心能力）
- [ ] 枚举域基本信息：域名、域控、信任关系（如有）
- [ ] 枚举用户/组/计算机列表（尤其：管理员组、服务账号、关键服务器）
- [ ] 枚举 SPN（服务账号）列表（为 Kerberos 相关攻击/审计做准备）
- [ ] 枚举共享与可读文件：SYSVOL / NETLOGON / 部门共享（重点：脚本、配置、备份）
- [ ] 查找 GPP（Groups.xml 等）是否泄露历史口令（老环境常见）
- [ ] 枚举本地管理员分布线索（谁对哪些机器有 Local Admin）
- [ ] 运行 BloodHound 采集并导入，能读懂最短路径/权限边
- [ ] 记录“可横向的目标机”（WinRM/RDP/SMB 可登录的机器清单）

---

## ✅ 4) 常见 AD 攻击链练习目标（OSCP 常见“会考的套路”）
> 目标不是死记工具，而是：**你能解释“为什么能升级权限/横向”**

### A. 密码喷洒/复用（合规前提下）
- [ ] 能从已得密码推测复用范围（服务账号/普通用户/本地管理员）
- [ ] 能基于策略/锁定风险制定“低风险验证方式”（避免炸号）

### B. Kerberos 相关（理解层面 + 练习）
- [ ] 理解 SPN 账户为何是高价值目标（服务票据与口令强度相关）
- [ ] 理解“无预认证账户”风险点（如果环境存在）
- [ ] 能从“拿到的新凭据/哈希”持续扩大可访问面（横向/提权）

### C. ACL/权限配置错误（BloodHound 常见路径）
- [ ] 能识别并利用常见危险权限：GenericAll / GenericWrite / WriteOwner / WriteDACL
- [ ] 能识别组成员可写/可控导致的提权链（“我能把自己加进某组”）
- [ ] 能识别对服务账号/计算机账号的可写权限带来的风险

### D. GPO / 登录脚本 / SYSVOL 泄露
- [ ] 检查 SYSVOL/NETLOGON 中的脚本/配置是否含凭据
- [ ] 检查 GPO 相关文件是否存在敏感信息（历史密码/映射盘脚本等)

### E. 本地提权 → 域横向
- [ ] 在成员机拿到本地管理员后，能提取/复用凭据（合规环境下）
- [ ] 能通过成员机的访问权限扩散到更多主机（WinRM/SMB/RDP）

---

## ✅ 5) 横向移动（拿到更多机器）
- [ ] 能用 1 种方式稳定横向（WinRM 或 SMB 远程执行任选其一）
- [ ] 能判断一台机器是否值得打（是否有高价值会话/管理员登录痕迹/关键服务器）
- [ ] 能整理“可登录机器矩阵”（用户 → 机器 → 协议）

---

## ✅ 6) 夺取高权限（目标：DC / 域管）
- [ ] 能识别“直达 DA 的最短路径”（BloodHound shortest path）
- [ ] 能通过 1 条完整路径拿到高权限（例如：ACL 链/组链/凭据链/配置泄露链）
- [ ] 能解释最终拿到 DA/DC 的关键原因（不是只会跑命令）

---

## ✅ 7) 报告与复盘（考试加分项）
- [ ] 记录每一步关键证据（截图点：枚举结果、权限证明、成功登录、提权证明）
- [ ] 写清攻击链：入口 → 枚举 → 横向 → 提权 → 最终权限
- [ ] 给出修复建议（最少：最小权限、强口令、禁用不必要服务、审核 ACL/GPO）

---

## 🎯 自测标准（你算“搞定 AD”的最低门槛）
- [ ] 看到“域环境”，10 分钟内能确认 DC、域名、关键服务
- [ ] 拿到低权后，能用枚举+BoodHound找到至少 1 条可行提权/横向路径
- [ ] 能把凭据/权限线索转成“可登录机器/可升级权限”的实际进展
- [ ] 能写出可复现的攻击链笔记（考试当天能照着打）